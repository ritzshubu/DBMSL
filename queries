1.
a. Retrieve the customer ids of any product which has been ordered by agent "a06".
Retrieve the customer ids of any product which has been ordered by agent "a06".
b.  Retrieve cities in which customers or agents located.
 select city from customer union select city from agent;
c. List product ids which have been ordered by agents from the cities “Dargeling” or  “Srinagar”. 
  select  distinct(pid) from orders where  aid in (select aid from agent where city in( ’Darjeling’,’Srinagar’));   
d. Retrieve customer ids whose discounts are less than the maximum discount. 
 select cid from customer where discount < (  select max(discount)  from customer);
e. Retrieve product ids ordered by at least two customers. 
 select p.pid from product p where 2 < = (select count(distinct cid) from orders where pid = p.pid); 
f. For each (aid,pid) pair get the sum of the orders aid has placed for pid. 
 select pid, aid, sum(qty) TOTAL from orders group by pid, aid;
g. Retrieve product ids and total quantity ordered for each product when the total exceeds 1000. 
select pid, aid, sum(qty) TOTAL from orders group by pid, aid having sum(qty) > 1000; 
h. List the names of the customers and agent who placed an order through that agent. 
 select distinct cname, aname from customer, orders, agent where customer.cid = orders.cid and orders.aid = agent.aid; 
i.  Retrieve the order numbers placed by customers in "Dargeling" through agents in "NewDelhi". 
>select ordno from orders where cid in (select cid  from customer where city =  ’Darjeling’) and  aid in (select aid from agent where city = ’NewDelhi’);
j.  Retrieve names of the customers who have the same discount as that of any (one) of the  customers in "Dargeling" or "Bangalore". 
 select cname from customer where discount =any (select discount from customer  where city = ’Darjeling’ or city = ’Bangalore’);
k. Retrieve customer ids with smaller discounts than every customer from " Srinagar”
  select cid from customer where discount < all (select discount from customer where city = ’Srinagar’); 
l. Retrieve names of the customers who have placed an order through agent "a05"   (using exists ) 
  select cname from customer  where cid in (select cid from orders where aid='a05'); 
m.  Retrieve names of the customers who do not place orders through agent "a05".(using not exists)
select cname from customer where cid not in  (select cid from orders where orders.aid = 'a05');
n. Retrieve customer ids whose orders placed through all the agents in "New Delhi". Get cid values of customers such that (the set of agents from " NewDelhi " through whom the customer has NOT placed an order) is EMPTY.
select c.cid  from customer c where not exists  (select * from agent a where a.city = ’NewDelhi’  and not exists   (select * from orders o where o.cid=c.cid and o.aid=a.aid)); 
o.  Retrieve agent ids either from "NewDelhi" or "Srinagar" who place orders for ALL products priced over fifteen rupee. Get aid values of agents from "New York" or "Duluth" such that (the set of products priced over one dollar that the agent has NOT ordered) is EMPTY
select a.aid from agent a where (a.city in (’NewDelhi’,’Srinagar’)) and not exists (select p.pid from product p where p.price > 15.00 and not exists (select * from orders o where o.pid = p.pid and o.aid = a.aid)); 
p. Retrieve names and ids of the customers and agents along with total sales for that pair. Order the result from largest to smallest total sales. Also retain only those pairs for which total rupee sales is at least 9000.00. 
 select c.cname, c.cid, a.aname, a.aid, sum(o.ordamount) from customer c, orders o, agent a where c.cid = o.cid and o.aid = a.aid group by c.cname, c.cid, a.aname, a.aid having sum(o.ordamount) >= 9000.00 order by 5 desc; 
q.  Increase the percent commission by 50% for all agents in "NewDelhi". 
 update agent set percent = 1.5 * percent where city = ’NewDelhi; 
r.Retrieve the total quantity that has been placed for each product 
 select pid, sum(qty) TOTAL  from orders group by pid; 
 
 
